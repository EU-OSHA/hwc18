<?php
/**
 * @file
 * Code for the HWC Good Practice Exchange feature.
 */

include_once 'hwc_good_practice_exchange.features.inc';

/**
 * Implements hook_block_info().
 */
function hwc_good_practice_exchange_block_info() {
  $blocks = array();
  $blocks['gpe_links'] = array(
    'info' => t('Good Practice Exchange Links'),
    'status' => 1,
    'region' => '-1',
    'visibility' => BLOCK_VISIBILITY_NOTLISTED,
    'cache' => DRUPAL_NO_CACHE,
  );
  $blocks['gpe_tools_publications'] = array(
    'info' => t('Good Practice Exchange Tools & Publications'),
    'status' => 1,
    'region' => '-1',
    'visibility' => BLOCK_VISIBILITY_NOTLISTED,
    'cache' => DRUPAL_NO_CACHE,
  );
  return $blocks;
}

/**
 * Implements hook_block_view().
 */
function hwc_good_practice_exchange_block_view($delta = '') {
  $block = array();
  if ($delta == 'gpe_links') {
    $prefix = '<div class="col-xs-12 col-sm-4">';
    $suffix = '</div>';
    $items = [];
    $items[] = l(
      '<span class="link-img"></span><span class="title">' . t('Become a campaign partner') . '</span>',
      'partner/register',
      ['html'=>TRUE, 'attributes' => ['class' => 'become-campaign-partner']]);
    $items[] = l(
      '<span class="link-img"></span><span class="title">' . t('Get involved in Good Practice exchange initiative') . '</span>',
      '/good-practice-exchange-initiative',
      ['absolute' => TRUE, 'html'=>TRUE, 'attributes' => ['class' => 'get-involved']]);
    $items[] = l(
      '<span class="link-img"></span><span class="title">' . t('Access to the private zone') . '</span>',
      'private',
      ['html'=>TRUE, 'attributes' => ['class' => 'private-zone']]);
    $block['subject'] = '';
    $block['content']['menu']['#markup'] = '<div class="gpe-links-block">' . $prefix . implode($suffix . $prefix, $items) . $suffix . '</div>';
  }

  if ($delta == 'gpe_tools_publications') {
    $block['subject'] = l(t('Tools and publications'), 'tools_and_publications');
    $items = [];
    $items[] = l(t('Case studies'),'case-studies', ['attributes' => ['class' => 'case-studies']]);
    $items[] = l(t('Publications'),'publications', ['attributes' => ['class' => 'publications']]);
    $items[] = l(t('DS e-tool'),'e-tool', ['attributes' => ['class' => 'e-guides']]);
    $block['content']['menu']['#markup'] = theme('item_list', array('items' => $items, 'attributes' => array('class' => 'menu nav')));
    $block['content']['link'] = array(
      'type' => 'item',
      '#prefix' => '<div class="more-link">',
      '#markup' => l(t('See other Tools and Publications'), 'tools_and_publications'),
      '#suffix' => '</div>',
    );
  }

  return $block;
}
